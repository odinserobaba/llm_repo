# Модуль 1 — Фундамент: карта понимания

```
┌─────────────────────────────────────────────────────────────┐
│  ФУНДАМЕНТ как научиться писать: ручка → буквы → слова     │
├────────────┬────────────┬────────────┬──────────────────────┤
│ Якорь      │ Механика   │ Прорыв     │ Применение           │
│ 3 сек      │ 20 сек     │ ✨ 5 сек   │ 10 сек               │
│ Chat vs    │ Шаблон +   │ JSON из    │ Локальные модели      │
│ Completion │ Few-shot   │ схемы      │ для офлайна          │
└────────────┴────────────┴────────────┴──────────────────────┘
```

---

## 🎯 Якорь + эмоциональный мостик

**🎯 ЯКОРЬ:** Письмо другу — ты можешь дописать начало (completion) или написать диалог с ролями (chat). LLM работает так же: одно — «продолжи текст», другое — «ответь как ассистент».

💡 **Эмпатия:** «Звучит абстрактно? Сейчас станет проще, чем выбрать шаблон сообщения в мессенджере.»

---

## 📖 Термины и понятия

| Термин | Что это | Метафора |
|--------|---------|----------|
| **LLM** | Большая языковая модель (GPT, LLaMA). Предсказывает следующий токен. | 🧠 Мозг, обученный на текстах |
| **Completion** | «Продолжи строку» — без ролей. | ✏️ Автодополнение в телефоне |
| **Chat** | Диалог с ролями (system, user, assistant). | 💬 Переписка в мессенджере |
| **Template** | Шаблон с `{name}`. Подстановка через `format()`. | 📋 Бланк с пустыми полями |
| **Few-shot** | 2–5 примеров «вход → выход» в промпте. | 📚 Образцы в магазине |
| **OutputParser** | Текст → JSON/структура по Pydantic-схеме. | 📥 Сканер анкеты |
| **Temperature** | 0–1: выше = разнообразнее. 0.2 — стабильно. | 🌡️ Кнопка «креативности» |
| **Pydantic** | Валидация и типы. Схема → проверка. | ✅ Контроль качества |

---

## 📐 Радиальная карта модуля

```
                         ┌──────────────────┐
                         │   ФУНДАМЕНТ      │ ← ЦЕНТР
                         │   (Модуль 1)     │
                         └────────┬─────────┘
              ┌───────────────────┼───────────────────┐
              ↓                   ↓                   ↓
       ┌────────────┐     ┌────────────┐     ┌────────────┐
       │ Интерфейсы │     │ Промпты    │     │ Результат  │
       │ (2 типа)   │     │ (3 приёма) │     │ (2 артефакта)│
       └─────┬──────┘     └─────┬──────┘     └─────┬──────┘
             ↓                  ↓                   ↓
       • Completion       • Template           • OutputParser
       • Chat             • Few-shot           • Локальные LLM
```

→ **Правило 7±2:** Chat, Completion, Template, Few-shot, Parser, Local — 6 ключевых понятий.

---

## 🔷 Прогрессивная схема (3 фазы)

#### Фаза 1: Выбор интерфейса
```
┌──────────────┐
│  Запрос      │
│  пользователя│
└──────┬───────┘
       ↓
┌──────────────────────────────────┐
│  Completion ИЛИ Chat?            │ ← выбор по задаче
└──────┬───────────────────────────┘
       ↓
   Completion: строка → продолжение
   Chat: роли (system/user) → ответ
```

#### Фаза 2: Управление промптом
```
┌──────────┐     ┌──────────┐     ┌──────────┐
│ Шаблон   │ ─→  │ Данные   │ ─→  │ Промпт   │
│ Template │     │ (format) │     │ готов    │
└──────────┘     └──────────┘     └────┬─────┘
       │                │              │
       └────────────────┴──────────────┘
                         ↓
              Few-shot примеры задают СТИЛЬ
```

#### Фаза 3: Прорыв ← ✨ ВОТ ЗДЕСЬ МАГИЯ!
```
┌──────────────┐
│ Pydantic     │
│ схема        │
└──────┬───────┘
       ↓
✨ Схема → инструкция формата → LLM возвращает JSON
   Бизнес получает СТРУКТУРУ, а не «свободный текст»
```

---

## 📊 Таблица контрастов

| Что думают ❌ | Что на самом деле ✅ | Визуальная метафора |
|---------------|---------------------|----------------------|
| «Chat и Completion — одно и то же» | Chat = роли + контекст, Completion = «продолжи строку» | `Chat = диалог в мессенджере` ⇄ `Completion = автодополнение` |
| «Достаточно написать промпт вручную» | Без Template — хаос при масштабе | `Template = бланк с полями` |
| «LLM всегда возвращает текст» | OutputParser превращает текст в JSON по схеме | `Парсер = сканер анкеты` |

---

## 💻 Мини-код с комментариями-стрелками

```python
# ← 1. Chat — основной путь (роли + ответ)
llm = ChatOpenAI(model="gpt-5-mini", temperature=0.2)
msg = [HumanMessage(content="Сделай заголовок")]
answer = llm.invoke(msg)
#        ↑
#        └─── ✨ ВОТ ЗДЕСЬ МАГИЯ: стабильный ответ с контролем температуры

# ← 2. Template — шаблон с подстановкой
template = "Товар: {name}. Опиши в 1 фразе."
prompt = PromptTemplate(input_variables=["name"], template=template)
ready = prompt.format(name="Термокружка")  # ← 3. Данные подставляются
# ← 4. Few-shot: примеры задают стиль
```

---

## ✅ Чек-лист самопроверки

```
✅ Проверь себя за 15 секунд:
▫️ Могу объяснить Chat vs Completion через метафору «диалог vs автодополнение»
▫️ Вижу разницу между Template и «просто строка»
▫️ Знаю, где прорыв (✨ OutputParser превращает текст в JSON)
▫️ Могу привести пример: товар → описание в 1 фразе
▫️ Понимаю, зачем локальные модели (приватность, офлайн)

→ Если 4+ галочки — уверенно владеешь основой.
```

---

## 🔍 Микро-проверка

**Вопрос:** Чем Chat отличается от Completion?  
**Ответ:** Chat = роли (system/user/assistant) + контекст диалога. Completion = одна строка на вход, продолжение на выход. Как переписка vs автодополнение.

**Вопрос:** Зачем OutputParser, если модель и так возвращает текст?  
**Ответ:** Бизнесу нужна структура (JSON, список) — для API, БД. Парсер превращает свободный текст в поля по схеме.

---

## ⚠️ Частые ошибки

| Ошибка | Решение |
|--------|---------|
| Путаешь Chat и Completion — разные интерфейсы | Chat = `ChatMessage`, Completion = `invoke(str)` |
| Template без input_variables — KeyError | Проверь `{name}` в template и `format(name=...)` |

---

## ➡️ Что дальше

- **Модуль 2** — Chains: собирай шаги в цепочки (очистка → суммаризация).
- **Практика:** свой Template с 2–3 переменными и few-shot.

**≈30 мин** — пробежать все блокноты | **≈1 ч** — с упражнениями

---

## 📁 Блокноты модуля

| Файл | Якорь | Что делаем |
|------|-------|-------------|
| `01_llm_vs_chatmodel.ipynb` | Говорить vs писать письмо | Completion vs Chat |
| `02_prompt_template_fewshot.ipynb` | Рецепт с пустыми полями | Template, Few-shot |
| `03_output_parser.ipynb` | Анкета по полям | Схема → JSON |
| `04_local_models.ipynb` | Готовить дома vs ресторан | GPU, локальная модель |

---

**Попробуй:** открой `01_llm_vs_chatmodel.ipynb` и пройди его сверху вниз.
