# Модуль 3 — Агенты и инструменты: подробный разбор

Этот файл — подробная теоретическая и практическая карта модуля 3.  
Он объясняет **зачем** нужен каждый блокнот, **как** работает ключевая техника и **как применять** её в реальных задачах.

---

## 1) `01_custom_tools.ipynb`

### Теория
**Инструменты (Tools)** — это контролируемые действия, которые агент может выполнять.  
Важно: инструмент должен быть безопасным, валидированным и предсказуемым.

**args_schema** — основной механизм валидации входных данных.  
Он защищает от некорректных типов, слишком больших значений и «вредных» запросов.

**Исторически:**  
Инструменты появились как способ интегрировать LLM в реальные системы: базы данных, API, сервисы.

### Практика в блокноте
Вы создаёте инструмент поиска товара:
- определяете входы через Pydantic‑схему;
- валидируете диапазоны;
- реализуете безопасную бизнес‑логику.

### Практические рекомендации
- Всегда используйте `args_schema`.  
- Не давайте агенту прямой доступ к БД без параметризации.  
- Логируйте все вызовы инструментов.

---

## 2) `02_agent_types.ipynb`

### Теория
**Function‑style агент** вызывает инструменты строго по схемам.  
**ReAct‑агент** «рассуждает» и принимает решения пошагово.

**Исторически:**  
ReAct стал популярным в исследовательской среде, когда нужно было повышать гибкость.  
Function‑style набрал популярность в продакшене за счёт предсказуемости.

### Практика в блокноте
Вы используете один и тот же инструмент и сравниваете два типа агентов:
- точность вызова инструмента;
- гибкость;
- контролируемость.

### Практические рекомендации
- Для продакшена чаще выбирают Function‑style.  
- ReAct полезен для сложных, «размытых» задач.  
- Если важен контроль — ограничивайте набор инструментов.

---

## 3) `03_agent_memory_security.ipynb`

### Теория
**Память агента** нужна, чтобы хранить контекст диалога: имя, предпочтения, историю шагов.  
`ConversationBufferWindowMemory` хранит последние N сообщений, защищая от переполнения токенов.

**Безопасность** — ключевой аспект: агент может получить опасные инструкции или попытаться вызвать рискованный инструмент.

**Исторически:**  
Память стала важной, когда агенты начали обслуживать длительные диалоги и задачи, а не одноразовые запросы.

### Практика в блокноте
Вы создаёте разговорную цепочку с памятью и демонстрируете:
- удержание имени пользователя;
- краткий пересказ диалога.

### Практические рекомендации
- Ограничивайте окно памяти (`k=3..5`).  
- Не храните секреты в памяти.  
- Валидируйте все входы инструментов.  
- Логируйте действия агента.

---

## Как использовать модуль 3

1. Начните с `01_custom_tools.ipynb` — поймёте, как безопасно подключать действия.  
2. Перейдите к `02_agent_types.ipynb` — сравните типы агентов.  
3. Завершите `03_agent_memory_security.ipynb` — добавите память и базовую безопасность.

---

## Итог модуля 3

К концу модуля вы:
- создаёте безопасные инструменты;
- выбираете подходящий тип агента;
- понимаете, как хранить контекст и защищать систему.
